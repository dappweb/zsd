"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33568],{21096:function(t,e,r){r.d(e,{C:function(){return a}});class a{overrideNextTransaction(t){this.contractWrapper.withTransactionOverride(t)}constructor(t){this.contractWrapper=t}}},13957:function(t,e,r){r.d(e,{C:function(){return c}});var a=r(45094),s=r(89586),o=r(13545),n=r(21325),i=r(12158);class c{async getAll(){(0,a.Z)(this.roles.length,"this contract has no support for roles");let t={},e=Object.entries(this.roles);return(await Promise.all(e.map(t=>{let[,e]=t;return this.get(e)}))).forEach((r,a)=>t[e[a][1]]=r),t}async get(t){(0,a.Z)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));let e=this.contractWrapper;if((0,o.h)("getRoleMemberCount",e)&&(0,o.h)("getRoleMember",e)){let r=(0,s.H)(t),a=(await e.read("getRoleMemberCount",[r])).toNumber();return await Promise.all(Array.from(Array(a).keys()).map(t=>e.read("getRoleMember",[r,t])))}throw Error("Contract does not support enumerating roles. Please implement IPermissionsEnumerable to unlock this functionality.")}async verify(t,e){await Promise.all(t.map(async t=>{let[r,a]=await Promise.all([this.get(t),(0,s.aL)(e)]);if(!r.map(t=>t.toLowerCase()).includes(a.toLowerCase()))throw new s.o(a,t)}))}async getRevokeRoleFunctionName(t){let[e,r]=await Promise.all([(0,s.aL)(t),this.contractWrapper.getSignerAddress()]);return r.toLowerCase()===e.toLowerCase()?"renounceRole":"revokeRole"}constructor(t,e){this.featureName=s.d4.name,this.setAll=(0,n.f)(async(t,e)=>{let r=e||await this.contractWrapper.getSignerAddress(),o=new i.C(this.contractWrapper),c=Object.keys(t);(0,a.Z)(c.length,"you must provide at least one role to set"),(0,a.Z)(c.every(t=>this.roles.includes(t)),"this contract does not support the given role");let l=await this.getAll(),p=[],h=c.sort(t=>"admin"===t?1:-1);for(let e=0;e<h.length;e++){var d,u;let a=h[e],[n,i]=await Promise.all([Promise.all((null===(d=t[a])||void 0===d?void 0:d.map(t=>(0,s.aL)(t)))||[]),Promise.all((null===(u=l[a])||void 0===u?void 0:u.map(t=>(0,s.aL)(t)))||[])]),c=n.filter(t=>!i.includes(t)),m=i.filter(t=>!n.includes(t));if(m.length>1){let t=m.indexOf(r);t>-1&&(m.splice(t,1),m.push(r))}c.length&&c.forEach(t=>{p.push(o.encode("grantRole",[(0,s.H)(a),t]))}),m.length&&(await Promise.all(m.map(t=>this.getRevokeRoleFunctionName(t)))).forEach((t,e)=>p.push(o.encode(t,[(0,s.H)(a),m[e]])))}return n.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"multicall",args:[p]})}),this.grant=(0,n.f)(async(t,e)=>{(0,a.Z)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));let r=await (0,s.aL)(e);return n.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"grantRole",args:[(0,s.H)(t),r]})}),this.revoke=(0,n.f)(async(t,e)=>{(0,a.Z)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));let r=await (0,s.aL)(e),o=await this.getRevokeRoleFunctionName(r);return n.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:o,args:[(0,s.H)(t),r]})}),this.contractWrapper=t,this.roles=e}}},33568:function(t,e,r){r.r(e),r.d(e,{Split:function(){return h}});var a=r(61501),s=r(8400),o=r(12158),n=r(89586),i=r(21325),c=r(13545),l=r(21096),p=r(13957);r(12016),r(98430),r(32942);class h{get chainId(){return this._chainId}onNetworkUpdated(t){this.contractWrapper.updateSignerOrProvider(t)}getAddress(){return this.contractWrapper.address}async getAllRecipients(){let t=[],e=a.O$.from(0),r=await this.contractWrapper.read("payeeCount",[]);for(;e.lt(r);)try{let r=await this.contractWrapper.read("payee",[e]);t.push(await this.getRecipientSplitPercentage(r)),e=e.add(1)}catch(t){if("method"in t&&t.method.toLowerCase().includes("payee(uint256)"))break;throw t}return t}async balanceOfAllRecipients(){let t=await this.getAllRecipients(),e={};for(let r of t)e[r.address]=await this.balanceOf(r.address);return e}async balanceOfTokenAllRecipients(t){let[e,r]=await Promise.all([(0,n.aL)(t),this.getAllRecipients()]),a={};for(let t of r)a[t.address]=await this.balanceOfToken(t.address,e);return a}async balanceOf(t){let[e,r,a]=await Promise.all([(0,n.aL)(t),this.contractWrapper.getProvider().getBalance(this.getAddress()),this.contractWrapper.read("totalReleased",[])]),s=r.add(a);return this._pendingPayment(e,s,await this.contractWrapper.read("released",[e]))}async balanceOfToken(t,e){let[a,i]=await Promise.all([(0,n.aL)(e),(0,n.aL)(t)]),c=(await Promise.resolve().then(r.t.bind(r,54497,19))).default,l=new s.CH(a,c,this.contractWrapper.getProvider()),[p,h,d]=await Promise.all([l.balanceOf(this.getAddress()),this.contractWrapper.read("totalReleased",[a]),this.contractWrapper.read("released",[a,i])]),u=p.add(h),m=await this._pendingPayment(i,u,d);return await (0,o.a)(this.contractWrapper.getProvider(),a,m)}async getRecipientSplitPercentage(t){let[e,r,s]=await Promise.all([(0,n.aL)(t),this.contractWrapper.read("totalShares",[]),this.contractWrapper.read("shares",[t])]);return{address:e,splitPercentage:s.mul(a.O$.from(1e7)).div(r).toNumber()/1e5}}async _pendingPayment(t,e,r){let[a,s]=await Promise.all([(0,n.aL)(t),this.contractWrapper.read("totalShares",[])]);return e.mul(await this.contractWrapper.read("shares",[a])).div(s).sub(r)}async prepare(t,e,r){return i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:t,args:e,overrides:r})}async call(t,e,r){return this.contractWrapper.call(t,e,r)}constructor(t,e,r){this.withdraw=(0,i.f)(async t=>i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address)",args:[await (0,n.aL)(t)]})),this.withdrawToken=(0,i.f)(async(t,e)=>i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address,address)",args:await Promise.all([(0,n.aL)(e),(0,n.aL)(t)])})),this.distribute=(0,i.f)(async()=>i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute()",args:[]})),this.distributeToken=(0,i.f)(async t=>i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute(address)",args:[await (0,n.aL)(t)]}));let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new n.cs(t,e,s,a,r);this._chainId=d,this.abi=n.bj.parse(s||[]),this.contractWrapper=u,this.storage=r,this.metadata=new c.C(this.contractWrapper,n.c7,this.storage),this.app=new c.b(this.contractWrapper,this.metadata,this.storage),this.roles=new p.C(this.contractWrapper,h.contractRoles),this.encoder=new o.C(this.contractWrapper),this.estimator=new c.G(this.contractWrapper),this.events=new c.a(this.contractWrapper),this.interceptor=new l.C(this.contractWrapper)}}h.contractRoles=n.dM}}]);